# GenrePage Visual Style Switching

## ะะฑะทะพั

`GenrePage` ัะตะฟะตัั ะฟะพะดะดะตัะถะธะฒะฐะตั ะฟะตัะตะบะปััะตะฝะธะต ะผะตะถะดั ะฒะธะทัะฐะปัะฝัะผะธ ััะธะปัะผะธ:

- **MINIMAL** (ะฟะพ ัะผะพะปัะฐะฝะธั) โ ะผะธะฝะธะผะฐะปะธััะธัะฝัะน "pro 80-x" ััะธะปั
- **RETRO_CLASSIC** โ ะบะธะฑerpะฐะฝะบ ััะธะปั ั ะฝะตะพะฝะพะฒัะผ ัะฒะตัะตะฝะธะตะผ (ะพะฟัะธะพะฝะฐะปัะฝะพ)

## ะัััััะน ััะฐัั

### ะะฐัะธะฐะฝั 1: ะัะฟะพะปัะทะพะฒะฐะฝะธะต ัะพะปัะบะพ MINIMAL (ะฑะตะท ัะตััะพ-ัะตะผั)

**ะะพ ัะผะพะปัะฐะฝะธั** ะฟัะพะตะบั ะบะพะผะฟะธะปะธััะตััั ะฑะตะท ัะตััะพ-ัะตะผั. ะัั ัะฐะฑะพัะฐะตั ะบะฐะบ ัะฐะฝััะต.

```cpp
// ะะธัะตะณะพ ะฝะต ะฝัะถะฝะพ ะดะตะปะฐัั โ MINIMAL ััะธะปั ะฐะบัะธะฒะตะฝ ะฟะพ ัะผะพะปัะฐะฝะธั
```

### ะะฐัะธะฐะฝั 2: ะะบะปััะตะฝะธะต RETRO_CLASSIC ััะธะปั

**ะจะฐะณ 1:** ะะฟัะตะดะตะปะธัะต ัะปะฐะณ `USE_RETRO_THEME` ะฟัะธ ะบะพะผะฟะธะปััะธะธ

ะ `platformio.ini` (ะตัะปะธ ะธัะฟะพะปัะทัะตัะต PlatformIO):
```ini
build_flags = 
    -DUSE_RETRO_THEME
```

ะะปะธ ะฒ Arduino IDE ะดะพะฑะฐะฒััะต ะฒ ะฝะฐัะฐะปะพ `genre_page.cpp`:
```cpp
#define USE_RETRO_THEME
```

**ะจะฐะณ 2:** ะะตัะตะบะปััะธัะต ััะธะปั ะฒ ะบะพะดะต

```cpp
// ะ miniacid_display.cpp ะธะปะธ ะณะดะต ัะพะทะดะฐััะต GenrePage:
auto genrePage = std::make_unique<GenrePage>(gfx, mini_acid, audio_guard);
genrePage->setVisualStyle(GenrePage::VisualStyle::RETRO_CLASSIC);
pages_.push_back(std::move(genrePage));
```

## API

### ะะตัะพะดั GenrePage

```cpp
// ะฃััะฐะฝะพะฒะธัั ะฒะธะทัะฐะปัะฝัะน ััะธะปั
void setVisualStyle(VisualStyle style);

// ะะพะปััะธัั ัะตะบััะธะน ััะธะปั
VisualStyle getVisualStyle() const;

// Enum ััะธะปะตะน
enum class VisualStyle {
    MINIMAL,       // ะะธะฝะธะผะฐะปะธััะธัะฝัะน (ะฟะพ ัะผะพะปัะฐะฝะธั)
    RETRO_CLASSIC  // ะะตััะพ-ะบะธะฑะตัะฟะฐะฝะบ (ััะตะฑัะตั USE_RETRO_THEME)
};
```

### ะัะธะผะตั ะดะธะฝะฐะผะธัะตัะบะพะณะพ ะฟะตัะตะบะปััะตะฝะธั

```cpp
// ะะตัะตะบะปััะตะฝะธะต ะฟะพ ะฝะฐะถะฐัะธั ะบะปะฐะฒะธัะธ (ะดะพะฑะฐะฒััะต ะฒ handleEvent):
if (e.key == 'v') {  // 'v' ะดะปั "visual"
    if (visualStyle_ == VisualStyle::MINIMAL) {
        setVisualStyle(VisualStyle::RETRO_CLASSIC);
    } else {
        setVisualStyle(VisualStyle::MINIMAL);
    }
    return true;
}
```

## ะะธะทัะฐะปัะฝัะต ัะฐะทะปะธัะธั

### MINIMAL Style
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ACID/CLEAN               140 BPMโ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ G>              T               โ
โ โข ACID          โข CLEAN         โ
โ   MINIMAL         DUB           โ
โ   TECHNO          DARK          โ
โ   ELECTRO         HARD          โ
โ   RAVE                          โ
โ                                 โ
โ [303 ACID] [DUB TECH] ...       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

- ะงะธัััะต ะณัะฐะฝะธัั
- ะะธะฝะธะผัะผ ะณัะฐัะธะบะธ
- ะััะพะบะฐั ัะธัะฐะตะผะพััั
- **ะะฐะทะผะตั:** ~0 KB ะดะพะฟะพะปะฝะธัะตะปัะฝะพ

### RETRO_CLASSIC Style
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โก GENRE โ ACID/CLEAN โ ๐ด 140  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ Gโณ              Tโณ              โ
โ โ แดแดษชแด          โ แดสแดแดษด         โ
โ โ MINIMAL       โ DUB           โ
โ โ TECHNO        โ DARK          โ
โ โ ELECTRO       โ HARD          โ
โ โ RAVE                          โ
โ                                 โ
โ โโโโโโโ โโโโโโโ โโโโโโโ         โ
โ โโ 303โ โ DUB โ โDARK โ ...     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

- ะะตะพะฝะพะฒะพะต ัะฒะตัะตะฝะธะต ัะตะบััะฐ
- LED ะธะฝะดะธะบะฐัะพัั
- ะกะฒะตัััะธะตัั ะณัะฐะฝะธัั
- ะฆะฒะตัะพะฒะพะต ะบะพะดะธัะพะฒะฐะฝะธะต ะถะฐะฝัะพะฒ
- **ะะฐะทะผะตั:** ~8 KB ะดะพะฟะพะปะฝะธัะตะปัะฝะพ (retro_ui_theme.h + retro_widgets.h)

## ะะฐะฒะธัะธะผะพััะธ

### MINIMAL (ะฒัะตะณะดะฐ ะดะพัััะฟะตะฝ)
- `ui_common.h/cpp`
- `layout_manager.h`
- ะกััะตััะฒัััะธะต ัะฒะตัะพะฒัะต ะบะพะฝััะฐะฝัั

### RETRO_CLASSIC (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- `retro_ui_theme.h` โ ะฟะฐะปะธััะฐ ัะฒะตัะพะฒ
- `retro_widgets.h` โ ะฒะธะดะถะตัั (drawLED, drawGlowText, etc.)
- ะคะปะฐะณ ะบะพะผะฟะธะปััะธะธ `USE_RETRO_THEME`

## ะะฐััะธัะตะฝะธะต (ะฑัะดััะธะต ััะธะปะธ)

ะ `genre_page.h` ะผะพะถะฝะพ ะดะพะฑะฐะฒะธัั:

```cpp
enum class VisualStyle {
    MINIMAL,
    RETRO_CLASSIC,
    CYBER_MATRIX,    // ะะฐััะธัะฝัะน ััะธะปั ั "ัะธััะพะฒัะผ ะดะพะถะดัะผ"
    TRON_GRID,       // ะะฐะดะธะฐะปัะฝะฐั ัะตัะบะฐ ะฒ ััะธะปะต Tron
    BRUTALIST        // ะงััะฝะพ-ะฑะตะปัะน ะฑัััะฐะปะธะทะผ
};
```

ะะฐัะตะผ ะฒ `genre_page.cpp`:

```cpp
void GenrePage::draw(IGfx& gfx) {
    switch (visualStyle_) {
        case VisualStyle::RETRO_CLASSIC:
            drawRetroClassicStyle(gfx);
            break;
        case VisualStyle::CYBER_MATRIX:
            drawCyberMatrixStyle(gfx);  // TODO
            break;
        case VisualStyle::MINIMAL:
        default:
            drawMinimalStyle(gfx);
            break;
    }
}
```

## ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

| ะกัะธะปั          | ะัะตะผั ะพััะธัะพะฒะบะธ | Flash  | RAM   |
|----------------|----------------|--------|-------|
| MINIMAL        | ~8ms           | +0 KB  | +0 KB |
| RETRO_CLASSIC  | ~12ms          | +8 KB  | +0 KB |

**ะะตะบะพะผะตะฝะดะฐัะธั:** ะัะฟะพะปัะทัะนัะต MINIMAL ะฝะฐ ัะปะฐะฑะพะผ ะถะตะปะตะทะต ะธะปะธ ะดะปั ะผะธะฝะธะผะธะทะฐัะธะธ flash.

## Troubleshooting

### ะัะธะฑะบะฐ: `'NEON_CYAN' was not declared`

**ะัะธัะธะฝะฐ:** ะะฐะฑัะปะธ ะพะฟัะตะดะตะปะธัั `USE_RETRO_THEME`

**ะะตัะตะฝะธะต:** 
```cpp
#define USE_RETRO_THEME
```
ะฟะตัะตะด `#include "genre_page.cpp"` ะธะปะธ ะฒ build flags.

### Retro ััะธะปั ะพัะพะฑัะฐะถะฐะตััั ะบะฐะบ Minimal

**ะัะธัะธะฝะฐ:** `USE_RETRO_THEME` ะฝะต ะพะฟัะตะดะตะปัะฝ ะฟัะธ ะบะพะผะฟะธะปััะธะธ

**ะะตัะตะฝะธะต:** ะัะพะฒะตัััะต ัะปะฐะณะธ ัะฑะพัะบะธ:
```bash
# PlatformIO
pio run -v | grep USE_RETRO_THEME

# Arduino CLI
arduino-cli compile --show-properties | grep USE_RETRO_THEME
```

### ะะตะดะปะตะฝะฝะฐั ะพััะธัะพะฒะบะฐ

**ะัะธัะธะฝะฐ:** ะญััะตะบัั ัะฒะตัะตะฝะธั ััะถัะปัะต ะฝะฐ ESP32

**ะะตัะตะฝะธะต:** 
- ะะฐะบะพะผะผะตะฝัะธััะนัะต `drawGlowText()` ะธ ะทะฐะผะตะฝะธัะต ะฝะฐ ะพะฑััะฝัะน `drawText()`
- ะัะฟะพะปัะทัะนัะต MINIMAL ััะธะปั
- ะฃะผะตะฝััะธัะต ัะฐะทัะตัะตะฝะธะต ัะบัะฐะฝะฐ

## ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะกัะฐัะธัะตัะบะพะต ะฟะตัะตะบะปััะตะฝะธะต ะฟัะธ ะทะฐะฟััะบะต

```cpp
// ะ MiniAcidDisplay::MiniAcidDisplay()
auto genre = std::make_unique<GenrePage>(gfx, mini_acid, audio_guard);

#ifdef HARDWARE_REV_2  // ะะพะปะตะต ะผะพัะฝะพะต ะถะตะปะตะทะพ
genre->setVisualStyle(GenrePage::VisualStyle::RETRO_CLASSIC);
#else
genre->setVisualStyle(GenrePage::VisualStyle::MINIMAL);
#endif

pages_.push_back(std::move(genre));
```

### ะะธะฝะฐะผะธัะตัะบะพะต ะฟะตัะตะบะปััะตะฝะธะต ัะตัะตะท ะฝะฐัััะพะนะบะธ

```cpp
// ะ SettingsPage ะดะพะฑะฐะฒััะต ะพะฟัะธั:
class SettingsPage {
    GenrePage* genrePage_;  // ะกะพััะฐะฝะธัะต ัะบะฐะทะฐัะตะปั
    
    void applyVisualTheme(int themeIndex) {
        if (genrePage_) {
            auto style = (themeIndex == 0) 
                ? GenrePage::VisualStyle::MINIMAL 
                : GenrePage::VisualStyle::RETRO_CLASSIC;
            genrePage_->setVisualStyle(style);
        }
    }
};
```

## ะกะพะฒะผะตััะธะผะพััั

- โ ESP32
- โ ESP32-S3 (Cardputer)
- โ SDL desktop build
- โ๏ธ ESP8266: ะขะพะปัะบะพ MINIMAL (ะฝะตะดะพััะฐัะพัะฝะพ RAM ะดะปั ัะตััะพ)

---

**ะกะพะทะดะฐะฝะพ ะดะปั MiniAcid Sequencer**  
*ะัะพััะพะน ะบะพะด + ะบัะฐัะธะฒะฐั ะณัะฐัะธะบะฐ = ะฟัะพัะตััะธะพะฝะฐะปัะฝัะน ะธะฝััััะผะตะฝั* ๐นโจ
